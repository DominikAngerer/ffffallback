<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>FFFFALLBACK</title>
  <style type="text/css" media="screen">
    body {
      color:#444;
      font: normal normal normal 1em/1.5 'Helvetica Neue', Arial, Helvetica, sans-serif;
    }
  </style>
</head>
<body>
  <hgroup>
    <h1>FFFFALLBACK</h1>
    <h2>A simple tool for bulletproof web typography.</h2>
  </hgroup>
  <p>Shhhh! This is top secret. Grab the bookmarklet and take it for a spin. Please send any and all feedback to me at <a href="mailto:josh@jbrewer.me">feedback@ffffallback.com</a></p>
  <p>This is the bookmarklet: <a id="bookmarklet" href="#">ffffallback</a>&mdash;drag it to your bookmarks bar and brace yourself for an onslaught of unicorns and rainbows.</p>
  <script>
    var myURL = window.location.toString();
    var baseURL;
    if(myURL.match(/\.html$/)) {
      var urlChunks = myURL.split('/');
      baseURL = urlChunks.slice(0, urlChunks.length - 1).join('/')
    } else {
      baseURL = myURL;
    }
    if(baseURL.substring(myURL.length - 1) !== '/') {
      baseURL += '/';
    }
    var jsURL = baseURL + 'bookmarklet/ffffallback.js?r=' + Math.random();
    var cssURL = baseURL + 'bookmarklet/ffffallback.css?r=' + Math.random();
    var bookmarkletSource = 'javascript:' +
"(function() {\
  var scriptTag = document.createElement('script');\
  scriptTag.setAttribute('src', '" + jsURL + "');\
  var linkTag = document.createElement('link');\
  linkTag.setAttribute('href', '" + cssURL + "');\
  linkTag.setAttribute('rel','stylesheet');\
  document.body.appendChild(scriptTag);\
  document.body.appendChild(linkTag);\
})();".replace(/\n/g, ' ');

    document.getElementById('bookmarklet').setAttribute('href', bookmarkletSource);
  </script>
</body>
</html>
